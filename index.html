<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="creator" content="Nandana Mihindukulasooriya">
    <link rel="icon" href="/docs/4.0/assets/img/favicons/favicon.ico">
    <title>Tools for the Semantic Web</title>

    <!-- Bootstrap core CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

    <script type="text/javascript" charset="utf8" src="https://code.jquery.com/jquery-3.7.1.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>

    <!-- data tables related -->
    <link href="https://cdn.datatables.net/v/bs5/jq-3.7.0/dt-2.0.1/datatables.min.css" rel="stylesheet">
    <script src="https://cdn.datatables.net/v/bs5/jq-3.7.0/dt-2.0.1/datatables.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/responsive/3.0.0/js/dataTables.responsive.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/responsive/3.0.0/js/responsive.dataTables.js"></script>

    <style>
        #mainTable {
          table-layout: fixed;
          width: 100% !important;
        }
        #mainTable td,
        #mainTable th{
          width: auto !important;
          white-space: normal;
          text-overflow: ellipsis;
          overflow: hidden;
        }
    </style>

</head>
<body>
    <header>
      <div class="navbar navbar-dark bg-dark box-shadow">
        <div class="container d-flex justify-content-between">
          <a href="#" class="navbar-brand d-flex align-items-center">
            <strong> Semantic Web Tool Hub</strong>
          </a>
            <div>
                 <a href="#" class="btn btn-primary my-2">Paper</a>
                <a href="https://github.com/achiminator/SW-Tool-Hub" class="btn btn-secondary my-2">GitHub</a>
                <a href="mailto:achim.reiz@uni-rostock.de" class="btn btn-info my-2">Contact</a>
            </div>

        </div>
      </div>
    </header>

     <main role="main">

<!--         <div class="py-5 bg-light">-->
            <div class="container">
                <div class="row">
                                              <p class="alert alert-primary" role="alert">
                    Tool Categories - Please click on a primary or a secondary category to see the list of tools queried from Wikidata.
                 </p>
                  <div class="col-4">
                    <div class="list-group" id="list-tab" role="tablist">
                      <a class="list-group-item list-group-item-action" id="list-kgre-list" data-bs-toggle="list" href="#list-area" role="tab" aria-controls="list-kgre" onclick="populateCategoryData('Q124614115', 'knowledge graph requirement elicitation')">Knowledge Graph Requirement Elicitation</a>
                      <a class="list-group-item list-group-item-action" id="list-oc-list" data-bs-toggle="list" href="#list-area" role="tab" aria-controls="list-oc" onclick="populateCategoryData('Q124614194', 'ontology modelling')">Ontology Modelling</a>
                      <a class="list-group-item list-group-item-action" id="list-oe-list" data-bs-toggle="list" href="#list-area" role="tab" aria-controls="list-oe" onclick="populateCategoryData('Q124413593', 'ontology evaluation')">Ontology Evaluation</a>
                      <a class="list-group-item list-group-item-action" id="list-kgp-list" data-bs-toggle="list" href="#list-area" role="tab" aria-controls="list-kgp" onclick="populateCategoryData('Q124614310', 'knowledge graph population')">Knowledge Graph Population</a>
                      <a class="list-group-item list-group-item-action" id="list-kgcev-list" data-bs-toggle="list" href="list-area" role="tab" aria-controls="list-kgcev" onclick="populateCategoryData('Q124614656', 'knowledge graph cleaning, evaluation & validation')">Knowledge Graph Cleaning, Evaluation & Validation</a>
                      <a class="list-group-item list-group-item-action active" id="list-kgq-list" data-bs-toggle="list" href="#list-area" role="tab" aria-controls="list-kgq" onclick="populateCategoryData('Q120970364', 'knowledge graph querying')">Knowledge Graph Querying</a>
                      <a class="list-group-item list-group-item-action" id="list-kgr-list" data-bs-toggle="list" href="#list-area" role="tab" aria-controls="list-kgr" onclick="populateCategoryData('Q124616131', 'knowledge graph reasoning')">Knowledge Graph Reasoning </a>
                      <a class="list-group-item list-group-item-action" id="list-kgs-list" data-bs-toggle="list" href="#list-area" role="tab" aria-controls="list-kgs" onclick="populateCategoryData('Q124615972', 'knowledge graph storage')">Knowledge Graph Storage </a>
                      <a class="list-group-item list-group-item-action" id="list-kgpu-list" data-bs-toggle="list" href="#list-area" role="tab" aria-controls="list-kgpu" onclick="populateCategoryData('Q124616041', 'Knowledge graph publication')">Knowledge Graph Publication </a>
                      <a class="list-group-item list-group-item-action" id="list-settings-list" data-bs-toggle="list" href="#list-area" role="tab" aria-controls="list-kgm" onclick="populateCategoryData('Q124616342', 'knowledge graph maintenance')">Knowledge Graph Maintenance </a>
                    </div>
                  </div>
                  <div class="col-8">
                    <div class="tab-content" id="nav-tabContent">
                      <div class="tab-pane fade show active" id="list-area" role="tabpanel" aria-labelledby="list-kgre-list">
                           <div class="card" role="tabpanel">
                              <div class="card-body">
                                  <h5 id="subCatListGroupTitle" class="card-title"></h5>
                                  <div id="subCatListGroup" class="list-group">
                                  </div>
                              </div>
                          </div>
                      </div>
                    </div>
                  </div>
                </div>
                </div>

                <hr class="hr hr-blurry" />

                <div class="card" style="width:90%; margin: auto;">
                     <div class="card-body" style="width:100%">
                        <h5 id="toolTableHeader" class="card-title"></h5>
                        <div class="alert alert-success" role="alert">
                        Please add missing information or correct the existing information by editing the Wikidata entity directly by clicking the link.
                        </div>
                        <table id="mainTable" class="table table-striped table-hover display responsive" style="width:100%">
                            <thead class="thead-dark">
                                <tr>
                                    <th>Wikidata</th>
                                    <th>Tool</th>
                                    <th>Developers</th>
                                    <th>Code repo</th>
                                    <th>Last Update</th>
                                    <th>License</th>
                                    <th>Website</th>

                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                     </div>

                 </div>

            </div>

<!--         </div>-->
     </main>




<script>
async function fetchWikidata(query) {
    const endpointUrl = 'https://query.wikidata.org/sparql';
    const headers = new Headers({
        'Accept': 'application/json'
    });

    const response = await fetch(endpointUrl + '?query=' + encodeURIComponent(query), { headers });
    const data = await response.json();
    return data.results.bindings;
}

function formatDate(inputDate) {
    // Split the date string into parts
    const parts = inputDate.split('T')[0].split('-');
    const year = parts[0];
    const month = parseInt(parts[1]);
    const day = parseInt(parts[2]);

    // Define suffix for day
    let daySuffix;
    switch (day) {
        case 1:
        case 21:
        case 31:
            daySuffix = "st";
            break;
        case 2:
        case 22:
            daySuffix = "nd";
            break;
        case 3:
        case 23:
            daySuffix = "rd";
            break;
        default:
            daySuffix = "th";
            break;
    }

    // Define month names
    const monthNames = [
        "January", "February", "March",
        "April", "May", "June", "July",
        "August", "September", "October",
        "November", "December"
    ];

    // Format the date
    const formattedDate = day + daySuffix + " " + monthNames[month - 1] + " " + year;
    return formattedDate;
}

function processMultipleUrls(inputString){
    var urls = inputString.split(',');
    var result = [];
    urls.forEach(function(url) {
        url = url.trim();
        var link = '<a href="' + url + '">' + url + '</a>';
        result.push(link);
    });
    var output = result.join('</br>');
    return output;
}

function getSubCategoryQuery(parentCategory){
    const sparqlQuery = `
        SELECT ?subcat ?subcatLabel WHERE {
          ?subcat wdt:P279+ wd:` + parentCategory + `;
                  rdfs:label ?subcatLabel .
          FILTER(LANG(?subcatLabel) = "en")
        }
    `;
    return sparqlQuery
}

function getWikidataQuery(tool_type_wd_id) {
    const sparqlQuery = `
        SELECT DISTINCT ?tool ?toolLabel ?update
        (GROUP_CONCAT(DISTINCT ?codeRepo; separator=",") as ?codeRepos)
        (GROUP_CONCAT(DISTINCT ?developerLabel; separator="</br>") as ?developers)
        (GROUP_CONCAT(DISTINCT ?website; separator=",") as ?websites)
        (GROUP_CONCAT(DISTINCT ?licenseLabel; separator="</br>") as ?licenses)

        WHERE {
          ?tool wdt:P366/wdt:P279* wd:` + tool_type_wd_id + `;
                       rdfs:label ?toolLabel .

          OPTIONAL { ?tool wdt:P178 ?developer . ?developer rdfs:label ?developerLabel FILTER(LANG(?developerLabel) = "en") }
          OPTIONAL { ?tool wdt:P1324 ?codeRepo }
          OPTIONAL { ?tool wdt:P856 ?website }
          OPTIONAL { ?tool wdt:P5017 ?update}
          OPTIONAL { ?tool wdt:P275 ?license . ?license rdfs:label ?licenseLabel FILTER(LANG(?licenseLabel) = "en")  }

          FILTER(LANG(?toolLabel) = "en")
        }
        GROUP BY ?tool ?toolLabel ?update
        ORDER BY ?toolLabel
    `;

    return sparqlQuery
}

DataTable.defaults.responsive = true;

function populateTable(tool_wd_id, tool_type) {
    const sparqlQuery = getWikidataQuery(tool_wd_id);
    fetchWikidata(sparqlQuery)
        .then(results => {
            $('#mainTable').DataTable().clear().draw();
            $('#mainTable').DataTable().destroy();
            const stateTable = $("#mainTable").DataTable({"pageLength": 25, responsive: true});
            stateTable.pageLength = 25;
            data_array = [];
            results.forEach(result => {
                wd = result.tool.value;
                wd_id = wd.replace('http://www.wikidata.org/entity/', '');
                const wd_link = '<a href="' + wd + '">' + wd_id + '</a>'
                const label = result.toolLabel.value;
                var repo = result.codeRepos ? result.codeRepos.value : '-';
                if (repo !== '-') {
                    repo = processMultipleUrls(repo);
                }
                const developers = result.developers ? result.developers.value : '-';
                var websites = result.websites ? result.websites.value : '-';
                if (websites !== '-') {
                    websites = processMultipleUrls(websites);
                }
                const licenses = result.licenses ? result.licenses.value : '-';
                update = result.update ? result.update.value :  '-';
                if (update !== '-') {
                    update = formatDate(update);
                }
                data_array.push([wd_link, label, developers, repo, update, licenses, websites])
            });
            stateTable.rows.add(data_array).draw();
            $("#toolTableHeader").text(results.length + " " + tool_type + " found in Wikidata");
        })
        .catch(error => console.error('Error fetching data from Wikidata:', error));  
}

function populateSubCategories(parentCategory) {
    const sparqlQuery = getSubCategoryQuery(parentCategory);
    fetchWikidata(sparqlQuery)
        .then(results => {
            if (results.length == 0) {
                $('#subCatListGroup').append('<a href="#" class="list-group-item list-group-item-action" data-bs-toggle="list" role="tab">No subcategories in Wikidata yet.</a>')
            }
            results.forEach(result => {
                const subcat = result.subcat.value;
                const subcatID = subcat.replace('http://www.wikidata.org/entity/', '');
                const subcatLabel = result.subcatLabel.value;
                $('#subCatListGroup').append('<a href="#" class="list-group-item list-group-item-action" data-bs-toggle="list" role="tab" onclick="populateTable(\'' + subcatID + '\',\'' + subcatLabel + '\')">' + subcatLabel + ' (' + subcatID + ') </a>')
            });
        });

}

function populateCategoryData(category_wd_id, category_label){
    $("#subCatListGroupTitle").text(category_label + ' subcategories');
    $('#subCatListGroup').empty();
    populateSubCategories(category_wd_id);
    populateTable(category_wd_id, category_label + ' tools');
}

populateCategoryData('Q120970364', 'knowledge graph querying');

</script>

</body>
</html>
